package main

import (
	"testing"
)

var base = hex2bigint("005D29206611838F1D02F3B54C92B746AA2660B4A1153586176D5B431D72CFE1A8AE6E7D565A5B214EFABF82689E5E973BCEBE2E71ACC710C4B40B7D014BA170DE2119B14661E62BEC98722616081BC817F78C73817531FEF353037798BFE27CD05DF957C738136D5D28F3EFF0815B1283645A3C83F40503732606671DCB4873C72AEDD5CD6BCAA250DC3D06C78A79F81794C542E741D7C9F67F84AD749FEDEB75370A3C2837D2C8C292C6274618FE1B89119BB5AF82096E4317479BFCF68B7D1498E4F292FA4064A35B6A0940EEAB28B6EF2FEEAA56EE4D8BDB4CDC38672651F5E82643FFD3228BFC2680F3BC1887AD8B8356EFB9D2EA8BB383F7FCFF5F6D5F")
var exp = hex2bigint("4F63A3C6F683901B562E8581052152A55E3B6D7FB9BA1E6DF48341A33353884CE787CFE361999FDFD977FACB5B6276B15F7CF1F17933425C088C1569277CF0FC5DE05A6D9778210AB9927FD7077EB8160E3B7BC4C51E33E4181F0F3060CCBFD8")
var mod = hex2bigint("942EBBCEEC7554B7D3E8064FB763B95D03D4E3FCBFCBF6B76A20F09EAD765AD443B5F01FCFF6033E013972584695CC33742B55C96E95EEE105692AC885191F39462B1DC9FAC1BE077D1F0F723E739CFA3170C04BE9B0E336843D79B803181F4C6892FBB0551DB36554ABA70FCB9FE16610251AEB69F79AE14A9ABC0D2426CBCF798FC4A2D849187699D05C7AF997698AA0C35529C95AB0FB0E301DA1160108A2F9059F2C9EB7ECD464202DBF98F13DE2DD1ADF766D0AF086D97B4BA5577213992D6FBE1ACBF14585A3FD2F2EA34E894A08B2CA8BFEB3ED485348410FED3925AD48DB0C9D254E28E6191CD4D427265F8F9F4EC5321EC6C99955587D232C75D1D9")
var result = hex2bigint("53E9B196BDCECE08033A29073B9BC01AB41BAEFF6CE5EEC714D31C2511C4E4318BE39B5846031B476A5940937104CB75E477E750EBB1483B42AB6BE3B2BD9A5C934790B0F3D6FF976105D377E578AA617F98E64C4069C0F776EE793FAD69C633A1CA441B41683B3CB82878779CD11576956676C6E23AA859857496A539506D34FA91A045CBD1DB82F05C93F848DE97DEC744CC1876FC763DA798DCE6460DFBDA53B29504F658E238322332C07E74878CFBE6294D05ACDFC95CC2AD94DC0E3C1737A4877F5F5F03630831755EDE7A93EE02F71F3CCD9511A5C725D78556505590B1DC47BF9ABC8778B80D008A2A580BE46FCD59B4AFA123568D65B47DCA40D7CA")

func TestModExp(t *testing.T) {
	got := ModExp(base, exp, mod)
	if got.Cmp(result) != 0 {
		t.Errorf("got %v, want %v", got, result)
	}
}

func TestModExpGo3rdParty(t *testing.T) {
	got := ModExpGo3rdParty(base, exp, mod)
	if got.Cmp(result) != 0 {
		t.Errorf("got %v, want %v", got, result)
	}
}

func TestModExpOpenSSL(t *testing.T) {
	got := ModExpOpenSSL(base, exp, mod)
	if got.Cmp(result) != 0 {
		t.Errorf("got %v, want %v", got, result)
	}
}
